(this["webpackJsonpemoji-cam"]=this["webpackJsonpemoji-cam"]||[]).push([[0],{277:function(e,t,n){},278:function(e,t,n){},284:function(e,t){},285:function(e,t){},293:function(e,t){},303:function(e,t,n){"use strict";n.r(t);var i=n(10),o=n.n(i),r=n(100),c=n.n(r),a=(n(277),n(278),n(318)),s=n(9),l=n.n(s),u=n(121),d=n(13),f=n(6),v=n(48),j=n(165);n(108);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"context",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"provider",o=Object(i.useContext)(e);return Object(i.useMemo)((function(){if(void 0===o)throw new Error("Attempting to use ".concat(t," outside of ").concat(n));return o}),[o])}var O=n(20),h=Object(i.createContext)(void 0),m={nose:0,left_eye:1,right_eye:2,left_ear:3,right_ear:4,left_shoulder:5,right_shoulder:6,left_elbow:7,right_elbow:8,left_wrist:9,right_wrist:10,left_hip:11,right_hip:12,left_knee:13,right_knee:14,left_ankle:15,right_ankle:16},g=function(e){var t=e.children,n=Object(i.useState)(),o=Object(f.a)(n,2),r=o[0],c=o[1];return Object(O.jsx)(h.Provider,{value:Object(i.useMemo)((function(){return{poses:r,setPoses:c}}),[r,c]),children:t})};function x(){return b(h,"PoseContext","PoseContextProvider")}var p=Object(i.createContext)(void 0),y=function(e){var t=e.children,n=Object(i.useState)(),o=Object(f.a)(n,2),r=o[0],c=o[1];return Object(O.jsx)(p.Provider,{value:Object(i.useMemo)((function(){return{message:r,setMessage:c}}),[r,c]),children:t})};function I(){var e=b(p,"ErrorMessageToUserContext");return[e.message,e.setMessage]}var k=Object(i.createContext)(void 0),C=function(e){var t=e.children,n=Object(i.useState)(),o=Object(f.a)(n,2),r=o[0],c=o[1];return Object(O.jsx)(k.Provider,{value:Object(i.useMemo)((function(){return{cameraId:r,setCameraId:c}}),[r,c]),children:t})};function S(){var e=b(k,"CameraSelectionContext");return[e.cameraId,e.setCameraId]}var M=Object(i.createContext)(void 0),_=function(e){var t=e.children,n=Object(i.useState)(),o=Object(f.a)(n,2),r=o[0],c=o[1],a=I(),s=Object(f.a)(a,2),l=(s[0],s[1]),u=S(),d=Object(f.a)(u,2),v=d[0];d[1];return Object(i.useEffect)((function(){c((function(e){null===e||void 0===e||e.getVideoTracks().forEach((function(e){return e.stop()}))})),navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:{exact:v}}}).then((function(e){c(e)})).catch((function(e){l("Unable to obtain camera stream. Error: ".concat(e.message))}))}),[l,v]),Object(O.jsx)(M.Provider,{value:Object(i.useMemo)((function(){return{videoSrcObject:r}}),[r]),children:t})};function w(){return b(M,"UserVideoStreamContext","UserVideoStreamProvider").videoSrcObject}var P=n(321),N=n(256),E=n.n(N);var T=Object(a.a)((function(e){return{root:{backgroundColor:"#ee886b",padding:16,height:60,borderRadius:30,boxSizing:"border-box",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},icon:{width:32,height:32}}})),D=function(e){var t=e.className,n=T(),o=function(){var e=Object(i.useState)(),t=Object(f.a)(e,2),n=t[0],o=t[1];return Object(i.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then((function(e){var t=e.filter((function(e){return"videoinput"===e.kind}));o(t)}))}),[]),n}(),r=S(),c=Object(f.a)(r,2),a=c[0],s=c[1],l=w(),u=Object(i.useMemo)((function(){var e;return void 0!==a?a:null===l||void 0===l||null===(e=l.getVideoTracks()[0])||void 0===e?void 0:e.getSettings().deviceId}),[a,l]),d=Object(i.useMemo)((function(){if(void 0!==u)return null===o||void 0===o?void 0:o.findIndex((function(e){return e.deviceId===u}))}),[u,o]),j=Object(i.useMemo)((function(){if(void 0!==o)return void 0!==d?(d+1)%o.length:0}),[o,d]),b=Object(i.useMemo)((function(){if(void 0!==o&&void 0!==j)return o[j]}),[o,j]);console.log(o);var h=Object(i.useCallback)((function(){void 0!==b&&s(b.deviceId)}),[b,s]);return console.log("cameras:"),console.log(o),console.log("camera ids:"),console.log(null===o||void 0===o?void 0:o.map((function(e){return e.deviceId}))),console.log("idOfCurrentCamera: ".concat(u)),console.log("currentDeviceIndex: ".concat(d)),console.log("nextDeviceIndex: ".concat(j)),console.log("nextCamera: ".concat(null===b||void 0===b?void 0:b.deviceId)),void 0===b||void 0===o||o.length<=1?null:Object(O.jsx)(P.a,{className:Object(v.a)(n.root,t),onClick:h,children:Object(O.jsx)(E.a,{className:n.icon})})},z=Object(a.a)((function(e){return{root:{transition:"opacity 0.5s"},fadedOut:{opacity:0},fadedIn:{opacity:1},video:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center center"},cameraSelector:{zIndex:10,position:"absolute",bottom:40,left:"calc(50% - 70px)",width:140}}})),F=function(e){var t=e.className,n=Object(i.useState)(null),o=Object(f.a)(n,2),r=o[0],c=o[1],a=Object(i.useState)(),s=Object(f.a)(a,2),b=s[0],h=s[1],m=w();Object(i.useEffect)((function(){var e={modelType:j.c.modelType.SINGLEPOSE_LIGHTNING};j.b(j.a.MoveNet,e).then((function(e){return h(e)}))}),[]);var g=Object(i.useState)(!1),p=Object(f.a)(g,2),y=p[0],I=p[1];Object(i.useCallback)((function(){return I(!0)}),[]);Object(i.useEffect)((function(){if(null!==r&&void 0!==m&&void 0!==b&&(console.log("videoEl nonnull, srcOgbject nonnull and detector nonnull"),r.srcObject=m,y)){console.log("video loaded data");var e=setInterval((function(){return C(r,b)}),50);return function(){clearInterval(e),I(!1),k(void 0)}}}),[r,m,b,y]);var k=x().setPoses,C=Object(i.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var i,o,r,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.estimatePoses(t);case 2:i=e.sent,o=H(t),r=o.scaleFactor,c=o.xOffset,a=o.yOffset,s=i.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{keypoints:e.keypoints.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{x:e.x*r+c,y:e.y*r+a})}))})})),k(s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),S=z();return Object(O.jsxs)("div",{className:Object(v.a)(S.root,t,m&&y?S.fadedIn:S.fadedOut),children:[Object(O.jsx)("video",{className:S.video,playsInline:!0,autoPlay:!0,onLoadedData:Object(i.useCallback)((function(){return I(!0)}),[]),ref:c}),Object(O.jsx)(D,{className:S.cameraSelector})]})};function H(e){var t=Math.max(e.clientWidth/e.videoWidth,e.clientHeight/e.videoHeight);return{scaleFactor:t,xOffset:Math.min(0,(e.clientWidth-t*e.videoWidth)/2),yOffset:Math.min(0,(e.clientHeight-t*e.videoHeight)/2)}}var U=Object(a.a)((function(e){return{root:{width:44,height:44,zIndex:1,position:"absolute",borderWidth:0,textAlign:"center",fontSize:62,lineHeight:"".concat(44,"px"),userSelect:"none",cursor:"default"}}})),W=function(e){var t=e.bodyPart,n=e.emoji,o=e.scoreThreshold,r=U(),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=x().poses;return Object(i.useMemo)((function(){var i=m[e];return null===n||void 0===n?void 0:n.map((function(e){return e.keypoints[i]})).filter((function(e){var n=e.score;return void 0!==n&&n>t}))}),[n,e])}(t,o);return Object(O.jsx)(O.Fragment,{children:null===c||void 0===c?void 0:c.map((function(e,t){return Object(O.jsx)("div",{className:r.root,style:{top:e.y-22,left:e.x-22},children:n},t)}))})},L=Object(a.a)((function(e){return{root:{fontSize:24,marginLeft:24,marginRight:24,textAlign:"center"}}})),V=function(e){var t=e.message,n=L();return void 0!==t?Object(O.jsx)("div",{className:n.root,children:t}):null},$=Object(a.a)((function(e){return{ldsEllipsis:{display:"inline-block",position:"relative",width:80,height:80,"& div":{position:"absolute",top:33,width:13,height:13,borderRadius:"50%",background:"#fff",animationTimingFunction:"cubic-bezier(0, 1, 1, 0)"},"& div:nth-child(1)":{left:8,animation:"$lds-ellipsis1 0.6s infinite"},"& div:nth-child(2)":{left:8,animation:"$lds-ellipsis2 0.6s infinite"},"& div:nth-child(3)":{left:32,animation:"$lds-ellipsis2 0.6s infinite"},"& div:nth-child(4)":{left:56,animation:"$lds-ellipsis3 0.6s infinite"}},"@keyframes lds-ellipsis1":{"0%":{transform:"scale(0)"},"100%":{transform:"scale(1)"}},"@keyframes lds-ellipsis3":{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)"}},"@keyframes lds-ellipsis2":{"0%":{transform:"translate(0, 0)"},"100%":{transform:"translate(24px, 0)"}}}})),A=function(){var e=$();return Object(O.jsxs)("div",{className:e.ldsEllipsis,children:[Object(O.jsx)("div",{}),Object(O.jsx)("div",{}),Object(O.jsx)("div",{}),Object(O.jsx)("div",{})]})},G=Object(a.a)((function(e){return{}})),R=function(e){e.children;var t=I(),n=Object(f.a)(t,1)[0];G();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(V,{message:n}),!n&&Object(O.jsx)(A,{})]})},J=Object(a.a)((function(e){return{video:{position:"absolute",width:"100%",height:"100%",top:0,left:0,right:0}}})),B=function(){var e=J();return Object(O.jsx)(g,{children:Object(O.jsx)(y,{children:Object(O.jsx)(C,{children:Object(O.jsxs)(_,{children:[Object(O.jsx)(R,{}),Object(O.jsx)(F,{className:e.video}),Object(O.jsx)(W,{bodyPart:"left_eye",emoji:"\u2764\ufe0f"}),Object(O.jsx)(W,{bodyPart:"right_eye",emoji:"\u2764\ufe0f"})]})})})})};c.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(B,{})}),document.getElementById("root"))}},[[303,1,2]]]);
//# sourceMappingURL=main.a8f381a9.chunk.js.map